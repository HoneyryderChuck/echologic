RPXNOW.loadAndRun(['Social'], function () {
  var activity = new RPXNOW.Social.Activity(
     "<%= I18n.t("application.general.share_comment") %>",
		 "<%= "made an #{shortcut_url(:shortcut => @shortcut_url.shortcut)}" %>",
		 "<%= shortcut_url(:shortcut => @shortcut_url.shortcut) %>");
		 
	activity.setTitle("Echo Made!");
	
	activity.setDescription("<%= @statement_document.text[0,255] %>...");
		 
  activity.addActionLink("Have your say!", "<%= root_url %>");
	activity.addTextProperty("wie!", "wie");
	<% if @statement_node.image.exists? %>
	 var img = new RPXNOW.Social.ImageMediaCollection();
	 img.addImage("<%= "http://#{ECHO_HOST}#{@statement_node.image.url(:medium)}" %>", "<%= root_url %>");
	 activity.setMediaItem(img);
	<% end %>
	
	<% timestamp = Time.now.utc.to_i %>
	<% message = Base64.encode64(Digest::SHA2.new(256).digest("#{timestamp}|#{current_user.id}")) %>
  RPXNOW.Social.publishActivity(activity, 
		{
		 primaryKey: "<%= current_user.id %>",
		 finishCallback: socialSharingFinished,
		 urlShortening: false,
		 timestamp: <%= timestamp %>,
		 signature: "<%= message.strip %>"
		 }
		);
});