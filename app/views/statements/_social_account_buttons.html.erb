<%
token_url = redirect_from_popup_to(add_remote_url,
                                   :redirect_url => statement_node_url(statement_node,
                                                                       :bids => @node_environment.bids.to_s,
                                                                       :origin => @node_environment.origin.to_s),
                                   :later_call => social_widget_statement_node_url(statement_node,
                                                                                   :bids => @node_environment.bids.to_s,
                                                                                   :origin => @node_environment.origin.to_s))
%>
<% content_tag(:div,
                :class => "social_account_list block center",
                'data-enabled' => I18n.t("users.social_accounts.share.enabled"),
                'data-disabled' => I18n.t("users.social_accounts.share.disabled")) do %>
  <% %w(facebook twitter yahoo! linkedin).each do |provider| %>
    <% connected = current_user.has_provider? provider %>
    <% css_provider = provider.eql?('yahoo!') ? 'yahoo' : provider %>
    <% css_classes = "social_label #{css_provider}#{connected ? ' connected' : ''}" %>
    <% content_tag(:div, :class => "social_account #{css_provider}") do %>
      <% if connected %>
        <% link_to('', connected.identifier, :target => "_blank", :class => css_classes) %>
        <% provider_switch_button(provider, true) %>
      else
        <% content_tag(:span, '', :class => css_classes) %>
        <% provider_connect_button(provider, token_url) %>
      end
    <% end %> 
  <% end %>
<% end %>